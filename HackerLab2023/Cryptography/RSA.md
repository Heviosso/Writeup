# RSA
```
70pts
```
## Description
```
[FR]

D√©cryptons !
[EN]

Let's decrypt !

Author: r3s0lv3r

Hint : x
```
## Solution

Le challenge nous pr√©sente un fichier "challgenge.txt" contenant les valeurs suivantes : 
```
x = 15469239512058184112766660901840951967872840313760129267579465698623970754602874047387246056269134620612740457177276396993820147369155228525814796551339847354302028185932886992277602537483695583488726686562366347521244021652165305309225456357542129119110087270432456013810825131029719954167476156609466214093094184946138046552774650586442805247170364813703969842287041233193206252623239765009604995530260331744620883488498508278824370660895130674361239480617591744373379880972418558958481843751386282162175018415685412141566532013554086334124860870166027149479791046291429770127600081556792094630452539778171903465100

n = 15383847875886234934369120135903277382005901590916521635441180182821031944592634423465692287502830647030428268618853876573235598195389559097626931298927988895539617177917756003247354079064235993332117890990339654420591979782408623713706929826438924430782511726676209717753627916253360957152267413145665559448518706493204232515140080837027684453269409816826730295515111144143807162640522776439405833012199557203191779192446193744566955716817868215638805338997662132820309031148501490955618621733654428553832823890554904937116949514171339120266119601133698087433836887528372681532456498691747869279275624692404687685128930304055206735295066333064733271829510944307558378093341010307856269982925726114935511196027594000411064524706278222555930677765758100846578291600795923763773763311058472007266885934159446442612650070967945403029368214188852326490793696987698474841587527719540569675410741647170255998782845693577096369235097195295005284263506286556944727114994490709649439991644590201568197371470563547081057984736340281782791319172165017559558681617814753097764933009488507847166829523317810550548101504676304017954168922018452411714386957248682658325737155598975763332466293190225589886661899184408281876944239878361064865415339

c = 15361637928603446646380253252091389546131156345233843420050254762206387288376963999427831639661208320539921324636742802439039381291996097172419456199987029610421842729123410091378032924745556782785578773798159654902182794235345260616041612923141380566544291061252903693973440868906102106304301202525315637417544550917628284948199568360622312715033362302927351078100391198109887687072481980136760047627010278830892020567934903636336983840533561685230236942404260611047338242189401791981201649250159664919451286180771880135890255604559971981657874593329256134491071639956575162248145359030355115976923515128800083790352588115877026226040648545494754236505782581652046498975712661232070816760227658250106504061148405801299561804022000304001271946791944461738294606740972270550737122424078549171620841595526117646952128071668121294004419158435692580869772999666573624011605103903184709527354967673327243877580511658300701791514850983003309796819131146939020526391289313985126251465577794202907445629896163138909961397588714873076773442700042783436395053260081427060955004832482433771370778113374647597294978106938949884038230430535863741130820975731729041015211078596247809208840677285782932481912258187240472454065791482332453300858020                                                                                              
```

Le nom du challenge est "RSA", ce qui nous sugg√®re imm√©diatement que nous devrions envisager une approche li√©e √† RSA.

Comme c'est typique pour les challenges RSA, nous commen√ßons par essayer de factoriser "n" pour trouver ses facteurs premiers. Cependant, dans ce cas particulier, il s'av√®re impossible de factoriser "n" car il est trop grand, d√©passant les capacit√©s de nos techniques habituelles.

Nous devons donc explorer d'autres pistes, et le param√®tre "x" donn√© dans l'exercice a une signification. Nous avons v√©rifi√© si "x" avait un facteur commun avec "n" en calculant le PGCD des deux nombres, mais cela n'a rien donn√©.

De plus, il y a un indice dans le challenge qui mentionne "x". Mais que signifie cet indice ? Nous savons que nous devons utiliser "x" pour peut-√™tre factoriser "n". Cependant, il est possible que "x" ne repr√©sente pas r√©ellement "x", mais plut√¥t la somme de nos nombres premiers.

Ainsi, nous aurions "n = p * q" et "x = p + q", avec "p" et "q" √©tant les deux nombres premiers. Cette relation vous rappelle quelque chose, n'est-ce pas ? La somme et le produit de deux nombres, cela ressemble √† quoi ? üòÖ

Nous pouvons alors calculer le discriminant et trouver nos deux solutions. Cependant, dans ce cas, nous pouvons utiliser directement "phi" sans passer par le calcul du discriminant.

En effet, "phi = (p - 1)(q - 1)" avec "p" et "q" √©tant nos nombres premiers. En factorisant "phi", nous obtenons :
```
phi = (p * q) - p - q + 1
phi = (p * q) - (p + q) + 1
phi = n - x + 1
```
√Ä partir de l√†, le reste du processus devient plus simple. Nous utilisons "phi" pour d√©terminer "d", puis nous pouvons calculer notre Flag. Le script suivant r√©sume le travail :
```python
from math import gcd
from Crypto.Util.number import *
e = 65537

x = 15469239512058184112766660901840951967872840313760129267579465698623970754602874047387246056269134620612740457177276396993820147369155228525814796551339847354302028185932886992277602537483695583488726686562366347521244021652165305309225456357542129119110087270432456013810825131029719954167476156609466214093094184946138046552774650586442805247170364813703969842287041233193206252623239765009604995530260331744620883488498508278824370660895130674361239480617591744373379880972418558958481843751386282162175018415685412141566532013554086334124860870166027149479791046291429770127600081556792094630452539778171903465100

n = 15383847875886234934369120135903277382005901590916521635441180182821031944592634423465692287502830647030428268618853876573235598195389559097626931298927988895539617177917756003247354079064235993332117890990339654420591979782408623713706929826438924430782511726676209717753627916253360957152267413145665559448518706493204232515140080837027684453269409816826730295515111144143807162640522776439405833012199557203191779192446193744566955716817868215638805338997662132820309031148501490955618621733654428553832823890554904937116949514171339120266119601133698087433836887528372681532456498691747869279275624692404687685128930304055206735295066333064733271829510944307558378093341010307856269982925726114935511196027594000411064524706278222555930677765758100846578291600795923763773763311058472007266885934159446442612650070967945403029368214188852326490793696987698474841587527719540569675410741647170255998782845693577096369235097195295005284263506286556944727114994490709649439991644590201568197371470563547081057984736340281782791319172165017559558681617814753097764933009488507847166829523317810550548101504676304017954168922018452411714386957248682658325737155598975763332466293190225589886661899184408281876944239878361064865415339

c = 15361637928603446646380253252091389546131156345233843420050254762206387288376963999427831639661208320539921324636742802439039381291996097172419456199987029610421842729123410091378032924745556782785578773798159654902182794235345260616041612923141380566544291061252903693973440868906102106304301202525315637417544550917628284948199568360622312715033362302927351078100391198109887687072481980136760047627010278830892020567934903636336983840533561685230236942404260611047338242189401791981201649250159664919451286180771880135890255604559971981657874593329256134491071639956575162248145359030355115976923515128800083790352588115877026226040648545494754236505782581652046498975712661232070816760227658250106504061148405801299561804022000304001271946791944461738294606740972270550737122424078549171620841595526117646952128071668121294004419158435692580869772999666573624011605103903184709527354967673327243877580511658300701791514850983003309796819131146939020526391289313985126251465577794202907445629896163138909961397588714873076773442700042783436395053260081427060955004832482433771370778113374647597294978106938949884038230430535863741130820975731729041015211078596247809208840677285782932481912258187240472454065791482332453300858020 

phi = n - x +1 

d = inverse(e,phi)

flag = pow(c,d,n)
flag = long_to_bytes(flag)
print(flag)
print(flag[::-1])
```

En √©x√©cutant le script nous obtenons notre flag

## Flag
```
Flag : CTF_RSA_3ncrypt10n_15_Fun!
```
